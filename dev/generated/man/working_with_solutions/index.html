<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Working with Solutions · QuantumCollocation.jl</title><meta name="title" content="Working with Solutions · QuantumCollocation.jl"/><meta property="og:title" content="Working with Solutions · QuantumCollocation.jl"/><meta property="twitter:title" content="Working with Solutions · QuantumCollocation.jl"/><meta name="description" content="Documentation for QuantumCollocation.jl."/><meta property="og:description" content="Documentation for QuantumCollocation.jl."/><meta property="twitter:description" content="Documentation for QuantumCollocation.jl."/><meta property="og:url" content="https://docs.harmoniqs.co/QuantumCollocation.jl/generated/man/working_with_solutions/"/><meta property="twitter:url" content="https://docs.harmoniqs.co/QuantumCollocation.jl/generated/man/working_with_solutions/"/><link rel="canonical" href="https://docs.harmoniqs.co/QuantumCollocation.jl/generated/man/working_with_solutions/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">QuantumCollocation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Usage Guide</span><ul><li><a class="tocitem" href="../problem_templates_overview/">Problem Templates Overview</a></li><li class="is-active"><a class="tocitem" href>Working with Solutions</a><ul class="internal"><li><a class="tocitem" href="#Solving-Problems"><span>Solving Problems</span></a></li><li><a class="tocitem" href="#Extracting-Data-from-Solutions"><span>Extracting Data from Solutions</span></a></li><li><a class="tocitem" href="#Evaluating-Solutions"><span>Evaluating Solutions</span></a></li><li class="toplevel"><a class="tocitem" href="#Evaluate-fidelity-only-in-computational-subspace"><span>Evaluate fidelity only in computational subspace</span></a></li><li><a class="tocitem" href="#Saving-and-Loading"><span>Saving and Loading</span></a></li><li class="toplevel"><a class="tocitem" href="#Use-as-initial-guess-for-new-problem"><span>Use as initial guess for new problem</span></a></li><li><a class="tocitem" href="#Post-Processing"><span>Post-Processing</span></a></li><li class="toplevel"><a class="tocitem" href="#Save-to-CSV-or-other-format-for-AWG"><span>Save to CSV or other format for AWG</span></a></li><li><a class="tocitem" href="#Best-Practices"><span>Best Practices</span></a></li></ul></li><li><a class="tocitem" href="../piccolo_options/">PiccoloOptions Reference</a></li></ul></li><li><a class="tocitem" href="../../../lib/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage Guide</a></li><li class="is-active"><a href>Working with Solutions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Working with Solutions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/harmoniqs/QuantumCollocation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/harmoniqs/QuantumCollocation.jl/blob/main/docs/literate/man/working_with_solutions.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Working-with-Solutions"><a class="docs-heading-anchor" href="#Working-with-Solutions">Working with Solutions</a><a id="Working-with-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-Solutions" title="Permalink"></a></h1><p>This guide covers how to solve problems, extract data from solutions, evaluate performance, and save/load results.</p><pre><code class="language-julia hljs">using QuantumCollocation
using PiccoloQuantumObjects
using NamedTrajectories</code></pre><h2 id="Solving-Problems"><a class="docs-heading-anchor" href="#Solving-Problems">Solving Problems</a><a id="Solving-Problems-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-Problems" title="Permalink"></a></h2><p>Once you&#39;ve created a problem template, solving is straightforward with the <code>solve!</code> function:</p><pre><code class="language-julia hljs">system = QuantumSystem(0.1 * PAULIS.Z, [PAULIS.X, PAULIS.Y], [1.0, 1.0])
U_goal = EmbeddedOperator(GATES.H, system)
T = 10.0 # time duration
qtraj = UnitaryTrajectory(system, U_goal, T)

N = 51 # number of timesteps
prob = SmoothPulseProblem(qtraj, N)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">QuantumControlProblem{PiccoloQuantumObjects.QuantumTrajectories.UnitaryTrajectory{PiccoloQuantumObjects.Pulses.ZeroOrderPulse{DataInterpolations.ConstantInterpolation{Matrix{Float64}, Vector{Float64}, Vector{Union{}}, Float64}}, SciMLBase.ODESolution{ComplexF64, 3, Vector{Matrix{ComplexF64}}, Nothing, Nothing, Vector{Float64}, Vector{Vector{Matrix{ComplexF64}}}, Nothing, SciMLBase.ODEProblem{Matrix{ComplexF64}, Tuple{Float64, Float64}, true, SciMLBase.NullParameters, SciMLBase.ODEFunction{true, SciMLBase.FullSpecialize, SciMLOperators.MatrixOperator{ComplexF64, Matrix{ComplexF64}, SciMLOperators.FilterKwargs{Nothing, Val{()}}, SciMLOperators.FilterKwargs{PiccoloQuantumObjects.Rollouts.var&quot;#update!#_construct_operator##2&quot;{PiccoloQuantumObjects.QuantumSystems.QuantumSystem{PiccoloQuantumObjects.QuantumSystems.var&quot;#26#27&quot;{SparseArrays.SparseMatrixCSC{ComplexF64, Int64}, Vector{SparseArrays.SparseMatrixCSC{ComplexF64, Int64}}, Int64}, PiccoloQuantumObjects.QuantumSystems.var&quot;#28#29&quot;{Vector{SparseArrays.SparseMatrixCSC{Float64, Int64}}, Int64, SparseArrays.SparseMatrixCSC{Float64, Int64}}, @NamedTuple{}}}, Val{()}}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, typeof(SciMLBase.DEFAULT_OBSERVED), Nothing, PiccoloQuantumObjects.Rollouts.PiccoloRolloutSystem{Union{Int64, AbstractVector{Int64}, CartesianIndex, CartesianIndices}}, Nothing, Nothing}, Base.Pairs{Symbol, Vector{Float64}, Nothing, @NamedTuple{tstops::Vector{Float64}, saveat::Vector{Float64}}}, SciMLBase.StandardODEProblem}, OrdinaryDiffEqLinear.MagnusGL4, OrdinaryDiffEqCore.InterpolationData{SciMLBase.ODEFunction{true, SciMLBase.FullSpecialize, SciMLOperators.MatrixOperator{ComplexF64, Matrix{ComplexF64}, SciMLOperators.FilterKwargs{Nothing, Val{()}}, SciMLOperators.FilterKwargs{PiccoloQuantumObjects.Rollouts.var&quot;#update!#_construct_operator##2&quot;{PiccoloQuantumObjects.QuantumSystems.QuantumSystem{PiccoloQuantumObjects.QuantumSystems.var&quot;#26#27&quot;{SparseArrays.SparseMatrixCSC{ComplexF64, Int64}, Vector{SparseArrays.SparseMatrixCSC{ComplexF64, Int64}}, Int64}, PiccoloQuantumObjects.QuantumSystems.var&quot;#28#29&quot;{Vector{SparseArrays.SparseMatrixCSC{Float64, Int64}}, Int64, SparseArrays.SparseMatrixCSC{Float64, Int64}}, @NamedTuple{}}}, Val{()}}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, typeof(SciMLBase.DEFAULT_OBSERVED), Nothing, PiccoloQuantumObjects.Rollouts.PiccoloRolloutSystem{Union{Int64, AbstractVector{Int64}, CartesianIndex, CartesianIndices}}, Nothing, Nothing}, Vector{Matrix{ComplexF64}}, Vector{Float64}, Vector{Vector{Matrix{ComplexF64}}}, Nothing, OrdinaryDiffEqLinear.MagnusGL4Cache{Matrix{ComplexF64}, Matrix{ComplexF64}, Matrix{ComplexF64}, Nothing}, Nothing}, SciMLBase.DEStats, Nothing, Nothing, Nothing, Nothing}, PiccoloQuantumObjects.EmbeddedOperators.EmbeddedOperator{ComplexF64}}}
  System: PiccoloQuantumObjects.QuantumSystems.QuantumSystem{PiccoloQuantumObjects.QuantumSystems.var&quot;#26#27&quot;{SparseArrays.SparseMatrixCSC{ComplexF64, Int64}, Vector{SparseArrays.SparseMatrixCSC{ComplexF64, Int64}}, Int64}, PiccoloQuantumObjects.QuantumSystems.var&quot;#28#29&quot;{Vector{SparseArrays.SparseMatrixCSC{Float64, Int64}}, Int64, SparseArrays.SparseMatrixCSC{Float64, Int64}}, @NamedTuple{}}
  Goal: PiccoloQuantumObjects.EmbeddedOperators.EmbeddedOperator{ComplexF64}
  Trajectory: 51 knots
  State: Ũ⃗
  Controls: u</code></pre><p>The <code>solve!</code> function accepts several key options:</p><pre><code class="language-julia hljs">solve!(prob;
    max_iter = 100,        # Maximum optimization iterations
    verbose = true,         # Print convergence information
    print_level = 1         # Ipopt output level (0-5)
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">    initializing optimizer...
        applying constraint: timesteps all equal constraint
        applying constraint: initial value of Ũ⃗
        applying constraint: initial value of u
        applying constraint: final value of u
        applying constraint: bounds on Ũ⃗
        applying constraint: bounds on u
        applying constraint: bounds on du
        applying constraint: bounds on ddu
        applying constraint: bounds on Δt
        applying constraint: time consistency constraint (t_{k+1} = t_k + Δt_k)
        applying constraint: initial time t₁ = 0

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************</code></pre><h3 id="Understanding-Convergence"><a class="docs-heading-anchor" href="#Understanding-Convergence">Understanding Convergence</a><a id="Understanding-Convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-Convergence" title="Permalink"></a></h3><p>Ipopt reports several key metrics:</p><ul><li><strong>Objective</strong>: Current cost function value</li><li><strong>inf_pr</strong>: Constraint violation (primal infidelity) - should go to ~0</li><li><strong>inf_du</strong>: Dual infidelity - measure of optimality</li><li><strong>lg(mu)</strong>: Log of barrier parameter</li><li><strong>alpha<em>du/alpha</em>pr</strong>: Step sizes</li></ul><p>Successful convergence typically shows <code>inf_pr</code> &lt; 1e-6 and status <code>Optimal Solution Found</code>.</p><h2 id="Extracting-Data-from-Solutions"><a class="docs-heading-anchor" href="#Extracting-Data-from-Solutions">Extracting Data from Solutions</a><a id="Extracting-Data-from-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Extracting-Data-from-Solutions" title="Permalink"></a></h2><h3 id="Accessing-Controls"><a class="docs-heading-anchor" href="#Accessing-Controls">Accessing Controls</a><a id="Accessing-Controls-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-Controls" title="Permalink"></a></h3><p>Control pulses are stored in the trajectory with automatic naming:</p><pre><code class="language-julia hljs">u = prob.trajectory.u       # Control values [n_drives × N]
du = prob.trajectory.du     # First derivatives
ddu = prob.trajectory.ddu   # Second derivatives

println(&quot;Control shape: &quot;, size(u))
println(&quot;Number of drives: &quot;, size(u, 1))
println(&quot;Number of timesteps: &quot;, size(u, 2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Control shape: (2, 51)
Number of drives: 2
Number of timesteps: 51</code></pre><p>Access individual drive controls:</p><pre><code class="language-julia hljs">u_drive_1 = u[1, :]   # First drive over time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">51-element Vector{Float64}:
 0.0
 0.09102972396310519
 0.1683407407610345
 0.22596245578236104
 0.26220656442967155
 0.2778324893716056
 0.27519111197603585
 0.25758291699716895
 0.22860014092405484
 0.19166799775224544
 ⋮
 0.20730834935883788
 0.20598862060908002
 0.19709453853529052
 0.18042351020245914
 0.1560649265242895
 0.12450022846037355
 0.0867252119063542
 0.04439604362165721
 0.0</code></pre><h3 id="Accessing-States"><a class="docs-heading-anchor" href="#Accessing-States">Accessing States</a><a id="Accessing-States-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-States" title="Permalink"></a></h3><p>For unitary problems:</p><pre><code class="language-julia hljs">Ũ⃗ = prob.trajectory.Ũ⃗  # Vectorized unitary [N² × T]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8×51 view(reshape(view(::Vector{Float64}, :), 16, 51), 1:8, :) with eltype Float64:
 1.0   0.999779      0.998895    0.996209   …   0.0214745    1.65558e-5
 0.0  -4.23077e-32  -0.0092729  -0.0270897     -0.00825884   4.5671e-6
 0.0  -0.0210169    -0.0420183  -0.0629547     -0.709828    -0.707091
 0.0  -3.48142e-33  -0.0189377  -0.0537388     -0.703971    -0.707095
 0.0   9.17594e-33   0.0092729   0.0270897      0.00825884  -4.5671e-6
 1.0   0.999779      0.998895    0.996209   …   0.0214745    1.65558e-5
 0.0   5.63116e-34  -0.0189377  -0.0537388     -0.703971    -0.707095
 0.0   0.0210169     0.0420183   0.0629547      0.709828     0.707091</code></pre><p>The unitary is stored in &quot;isovec&quot; format (vectorized). To get the actual unitary matrix at timestep k:</p><pre><code class="language-julia hljs">using LinearAlgebra
k = N  # Final timestep
U_k = iso_vec_to_operator(Ũ⃗[:, k])
println(&quot;Final unitary dimensions: &quot;, size(U_k))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Final unitary dimensions: (2, 2)</code></pre><p>For ket (state) problems, use: ψ̃ = prob.trajectory.ψ̃  # Vectorized state [2N × T]</p><h3 id="Time-Grid"><a class="docs-heading-anchor" href="#Time-Grid">Time Grid</a><a id="Time-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Grid" title="Permalink"></a></h3><p>Access timestep information:</p><pre><code class="language-julia hljs">Δt_vec = prob.trajectory.Δt  # Timestep durations</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×51 view(reshape(view(::Vector{Float64}, :), 16, 51), 9:9, :) with eltype Float64:
 0.210184  0.210184  0.210184  0.210184  …  0.210184  0.210184  0.210184</code></pre><p>Calculate total duration:</p><pre><code class="language-julia hljs">duration = get_duration(prob.trajectory)
println(&quot;Total gate time: &quot;, duration, &quot; (arbitrary units)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Total gate time: 10.509209626401601 (arbitrary units)</code></pre><p>For minimum time problems, timesteps vary: min<em>prob = UnitaryMinimumTimeProblem(prob, U</em>goal) solve!(min<em>prob, max</em>iter=100) Δt<em>optimized = min</em>prob.trajectory.Δt  # Variable timesteps</p><h2 id="Evaluating-Solutions"><a class="docs-heading-anchor" href="#Evaluating-Solutions">Evaluating Solutions</a><a id="Evaluating-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluating-Solutions" title="Permalink"></a></h2><h3 id="Fidelity-Calculations"><a class="docs-heading-anchor" href="#Fidelity-Calculations">Fidelity Calculations</a><a id="Fidelity-Calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Fidelity-Calculations" title="Permalink"></a></h3><p><strong>Direct fidelity</strong> - Compare final state to goal:</p><pre><code class="language-julia hljs">U_final = iso_vec_to_operator(prob.trajectory.Ũ⃗[:, end])
fid_direct = unitary_fidelity(U_final, U_goal.operator)
println(&quot;Direct fidelity: &quot;, fid_direct)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Direct fidelity: 0.9999607437739154</code></pre><p><strong>Rollout fidelity</strong> - Simulate dynamics forward:</p><pre><code class="language-julia hljs">fid_rollout = unitary_rollout_fidelity(prob.trajectory, system)
println(&quot;Rollout fidelity: &quot;, fid_rollout)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Rollout fidelity: 0.9997937552347185</code></pre><p>The rollout fidelity is more accurate as it accounts for actual dynamics, while direct fidelity only checks the final point.</p><h3 id="For-Embedded-Operators-(Multilevel-Systems)"><a class="docs-heading-anchor" href="#For-Embedded-Operators-(Multilevel-Systems)">For Embedded Operators (Multilevel Systems)</a><a id="For-Embedded-Operators-(Multilevel-Systems)-1"></a><a class="docs-heading-anchor-permalink" href="#For-Embedded-Operators-(Multilevel-Systems)" title="Permalink"></a></h3><p>When working with subspaces (e.g., qubit in transmon): op = EmbeddedOperator(:X, system) prob<em>embedded = UnitarySmoothPulseProblem(system, op, N) solve!(prob</em>embedded, max_iter=100)</p><h1 id="Evaluate-fidelity-only-in-computational-subspace"><a class="docs-heading-anchor" href="#Evaluate-fidelity-only-in-computational-subspace">Evaluate fidelity only in computational subspace</a><a id="Evaluate-fidelity-only-in-computational-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluate-fidelity-only-in-computational-subspace" title="Permalink"></a></h1><p>fid<em>subspace = unitary</em>rollout<em>fidelity(     prob</em>embedded.trajectory,     system;     subspace = op.subspace )</p><h3 id="Leakage-Evaluation"><a class="docs-heading-anchor" href="#Leakage-Evaluation">Leakage Evaluation</a><a id="Leakage-Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Leakage-Evaluation" title="Permalink"></a></h3><p>For multilevel systems, check population in leakage levels: This requires analyzing state populations during evolution See the Multilevel Transmon example for details</p><h3 id="Constraint-Violations"><a class="docs-heading-anchor" href="#Constraint-Violations">Constraint Violations</a><a id="Constraint-Violations-1"></a><a class="docs-heading-anchor-permalink" href="#Constraint-Violations" title="Permalink"></a></h3><p>Check if solution satisfies all constraints:</p><ul><li>Dynamics constraints: Compare rollout vs direct fidelity</li><li>Bound constraints: Verify controls within system.drive_bounds</li><li>Derivative constraints: Check |du|, |ddu| within bounds</li></ul><pre><code class="language-julia hljs">println(&quot;Max control value: &quot;, maximum(abs.(u)))
println(&quot;Max control derivative: &quot;, maximum(abs.(du)))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Max control value: 0.2778324893716056
Max control derivative: 0.43312082255200207</code></pre><h2 id="Saving-and-Loading"><a class="docs-heading-anchor" href="#Saving-and-Loading">Saving and Loading</a><a id="Saving-and-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-and-Loading" title="Permalink"></a></h2><h3 id="Save-a-Trajectory"><a class="docs-heading-anchor" href="#Save-a-Trajectory">Save a Trajectory</a><a id="Save-a-Trajectory-1"></a><a class="docs-heading-anchor-permalink" href="#Save-a-Trajectory" title="Permalink"></a></h3><p>using JLD2 save<em>object(&quot;my</em>solution.jld2&quot;, prob.trajectory)</p><h3 id="Load-and-Reuse"><a class="docs-heading-anchor" href="#Load-and-Reuse">Load and Reuse</a><a id="Load-and-Reuse-1"></a><a class="docs-heading-anchor-permalink" href="#Load-and-Reuse" title="Permalink"></a></h3><p>Load trajectory for warm-starting: traj<em>loaded = load</em>object(&quot;my_solution.jld2&quot;)</p><h1 id="Use-as-initial-guess-for-new-problem"><a class="docs-heading-anchor" href="#Use-as-initial-guess-for-new-problem">Use as initial guess for new problem</a><a id="Use-as-initial-guess-for-new-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Use-as-initial-guess-for-new-problem" title="Permalink"></a></h1><p>prob<em>refined = UnitarySmoothPulseProblem(     system, U</em>goal, T, Δt;     u<em>guess = traj</em>loaded.u,     piccolo_options = PiccoloOptions(verbose=false) )</p><h3 id="Save-Entire-Problem"><a class="docs-heading-anchor" href="#Save-Entire-Problem">Save Entire Problem</a><a id="Save-Entire-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Save-Entire-Problem" title="Permalink"></a></h3><p>To save all problem information including constraints and objectives: save<em>object(&quot;my</em>problem.jld2&quot;, prob)</p><h2 id="Post-Processing"><a class="docs-heading-anchor" href="#Post-Processing">Post-Processing</a><a id="Post-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Post-Processing" title="Permalink"></a></h2><h3 id="Resampling-Trajectories"><a class="docs-heading-anchor" href="#Resampling-Trajectories">Resampling Trajectories</a><a id="Resampling-Trajectories-1"></a><a class="docs-heading-anchor-permalink" href="#Resampling-Trajectories" title="Permalink"></a></h3><p>Change time discretization while preserving control shape: T<em>new = 101  # More timesteps traj</em>resampled = resample(prob.trajectory, T_new)</p><h3 id="Extracting-for-Experiments"><a class="docs-heading-anchor" href="#Extracting-for-Experiments">Extracting for Experiments</a><a id="Extracting-for-Experiments-1"></a><a class="docs-heading-anchor-permalink" href="#Extracting-for-Experiments" title="Permalink"></a></h3><p>Prepare control pulses for hardware:</p><pre><code class="language-julia hljs">using PiccoloPlots  # For visualization
using CairoMakie</code></pre><p>Plot controls</p><pre><code class="language-julia hljs">fig = plot(prob.trajectory)</code></pre><img src="ce49494a.png" alt="Example block output"/><p>save(&quot;controls.png&quot;, fig)</p><p>Extract control data for export</p><pre><code class="language-julia hljs">control_data = Dict(
    &quot;time&quot; =&gt; cumsum([0; prob.trajectory.Δt[:]]),
    &quot;drive_1_real&quot; =&gt; u[1, :],
    &quot;drive_2_real&quot; =&gt; u[2, :],
    &quot;duration&quot; =&gt; duration
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{String, Any} with 4 entries:
  &quot;duration&quot;     =&gt; 10.5092
  &quot;time&quot;         =&gt; [0.0, 0.210184, 0.420368, 0.630553, 0.840737, 1.05092, 1.26…
  &quot;drive_1_real&quot; =&gt; [0.0, 0.0910297, 0.168341, 0.225962, 0.262207, 0.277832, 0.…
  &quot;drive_2_real&quot; =&gt; [0.0, -0.0422436, -0.0797889, -0.110932, -0.135205, -0.1528…</code></pre><h1 id="Save-to-CSV-or-other-format-for-AWG"><a class="docs-heading-anchor" href="#Save-to-CSV-or-other-format-for-AWG">Save to CSV or other format for AWG</a><a id="Save-to-CSV-or-other-format-for-AWG-1"></a><a class="docs-heading-anchor-permalink" href="#Save-to-CSV-or-other-format-for-AWG" title="Permalink"></a></h1><p>using CSV, DataFrames df = DataFrame(control<em>data) CSV.write(&quot;pulse</em>sequence.csv&quot;, df)</p><h3 id="Pulse-Filtering"><a class="docs-heading-anchor" href="#Pulse-Filtering">Pulse Filtering</a><a id="Pulse-Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Pulse-Filtering" title="Permalink"></a></h3><p>Apply smoothing to reduce high-frequency noise: using DSP for i in 1:size(u, 1)     u_filtered[i, :] = filtfilt(responsetype, u[i, :]) end</p><h2 id="Best-Practices"><a class="docs-heading-anchor" href="#Best-Practices">Best Practices</a><a id="Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Best-Practices" title="Permalink"></a></h2><p><strong>Starting a new optimization:</strong></p><ol><li>Begin with coarse discretization (small T)</li><li>Use relaxed bounds and convergence criteria</li><li>Refine solution incrementally</li><li>Use previous solution as warm start</li></ol><p><strong>Debugging poor convergence:</strong></p><ol><li>Check <code>inf_pr</code> - high values indicate constraint violations</li><li>Verify system Hamiltonian is correct</li><li>Try looser derivative bounds (du<em>bound, ddu</em>bound)</li><li>Increase regularization weights (<code>R_u</code>, <code>R_du</code>, <code>R_ddu</code>)</li><li>Use <code>piccolo_options.bound_state=true</code> for better numerics</li></ol><p><strong>Improving solutions:</strong></p><ol><li>Increase T (more timesteps = finer control)</li><li>Add derivative constraints for smoother pulses</li><li>Use minimum time optimization for fastest gates</li><li>Apply leakage constraints for multilevel systems</li><li>Use sampling problems for robust control</li></ol><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../problem_templates_overview/">« Problem Templates Overview</a><a class="docs-footer-nextpage" href="../piccolo_options/">PiccoloOptions Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 21 January 2026 17:18">Wednesday 21 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
